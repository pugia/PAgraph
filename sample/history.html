<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<title>PAgraph | history</title>

	<script src="../node_modules/jquery/dist/jquery.min.js"></script>						
	<script src="../node_modules/d3/d3.min.js" charset="utf-8"></script>

<!--
	<link href="../dist/css/PAgraph.min.css" rel="stylesheet" type="text/css">
	<script src="../dist/js/PAgraph.min.js"></script>
-->
	
	<link href="../src/css/PAgraph.css" rel="stylesheet" type="text/css">
	<script src="../src/js/PAgraph.js"></script>
			
</head>
<body>	
	
	<h1>Mode: history</h1>
	
	<div id="graph_0" style="height: 500px; width: 1000px"></div>
	
	<div style="position: absolute; right: 0; top: 0; padding: 10px;">
		<button id="load13">Load 13</button><br/>
		<button id="load13b">Load 13 B</button><br/>
		<button id="load20">Load 20</button><br/>
		<button id="load7">Load 7</button><br/><br/>
		<button id="compare">Compare with 13 B</button>
		<button id="remove">Remove graph</button><br/><br/>
		<button id="test">Test</button>
	</div>

	<script>	
	
	$(function() {

		var graph = $('#graph_0').PAgraph({
			mode: 'history',
			config: {
				graph: [{
					color: '#88B8C4',
					legend: 'very very long text for main metric'
				}, {
					color: '#808E96',
					legend: 'compare metric'
				}]
			}
		});
		
		$('#load13').on('click', function() {

			$.getJSON('response/history_test_13gg.json')
				.done(function(result) {

					graph.mainGraph(APIdataToValues(result));
				
				})
			
		}).click();

		$('#load13b').on('click', function() {

			$.getJSON('response/history_test_13gg_b.json')
				.done(function(result) {
			
					graph.mainGraph(APIdataToValues(result),0);
				
				})
			
		})

		$('#load20').on('click', function() {

			$.getJSON('response/history_test_20gg.json')
				.done(function(result) {

					graph.mainGraph(APIdataToValues(result),0);
				
				})
			
		})

		$('#load7').on('click', function() {

			$.getJSON('response/history_test_7gg.json')
				.done(function(result) {
					graph.mainGraph(APIdataToValues(result),0);
				
				})
			
		})
		
		$('#compare').on('click', function() {

			$.getJSON('response/history_test_13gg_b.json')
				.done(function(result) {
			
					graph.compareWith(APIdataToValues(result));
				
				})
			
		})

		$('#remove').on('click', function() {
		
			graph.removeCompare();
			
		})
		
		
	})	
	
	// generate array with label and value
	function APIdataToValues(data) {
		
		var newData = [];
		var rows = data['rows'];
		
		for(var index in rows) {
						
			newData.push({
				label:		rows[index]['c'][0]['v'].replace(' 15', ''),
				value:		rows[index]['c'][1]['v']
			})
			 
		}
		
		return newData;
		
	}


	</script>
	
</body>

</html>